<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ØªØ²ÙƒÙŠØ© ÙƒÙ…Ø´ÙƒØ§Ø© - Ù„ÙˆØ­Ø© Ø§Ù„ØªØ­ÙƒÙ…</title>
    
    <!-- Ø§Ø³ØªØ¯Ø¹Ø§Ø¡ Tailwind CSS Ù„Ù„ØªÙ†Ø³ÙŠÙ‚ Ø§Ù„Ø³Ø±ÙŠØ¹ -->
    <script src="https://cdn.tailwindcss.com"></script>
    
    <!-- Ø§Ø³ØªØ¯Ø¹Ø§Ø¡ Ø®Ø· Ø§Ù„Ù‚Ø§Ù‡Ø±Ø© -->
    <link href="https://fonts.googleapis.com/css2?family=Cairo:wght@300;400;600;700&display=swap" rel="stylesheet">
    
    <!-- Ù…ÙƒØªØ¨Ø© Ø£ÙŠÙ‚ÙˆÙ†Ø§Øª Ø¨Ø³ÙŠØ·Ø© (Lucide) -->
    <script src="https://unpkg.com/lucide@latest"></script>

    <style>
        /* =========================================
         Ø¨Ø¯Ø§ÙŠØ© Ø§Ù„Ø³ØªØ§ÙŠÙ„Ø§Øª Ø§Ù„Ù…Ø¬Ù…Ø¹Ø© (style.css + dashboard.css)
         =========================================
        */

        :root {
            --primary-color: #047857; /* Ù„ÙˆÙ† Ø£Ø®Ø¶Ø± Ø¥Ø³Ù„Ø§Ù…ÙŠ - Emerald 700 */
            --primary-light: #10B981; /* Emerald 500 */
            --gold-accent: #D4AF37;   /* Ù„ÙˆÙ† Ø°Ù‡Ø¨ÙŠ */
            --bg-light: #F3F4F6;
        }

        body {
            font-family: 'Cairo', sans-serif;
            background-color: var(--bg-light);
            color: #1F2937; /* Gray 800 */
        }

        /* ØªØ®ØµÙŠØµ Ø§Ù„Ø³ÙƒØ±ÙˆÙ„ Ø¨Ø§Ø± */
        ::-webkit-scrollbar {
            width: 8px;
        }
        ::-webkit-scrollbar-track {
            background: #f1f1f1;
        }
        ::-webkit-scrollbar-thumb {
            background: var(--primary-color);
            border-radius: 4px;
        }
        ::-webkit-scrollbar-thumb:hover {
            background: #065f46;
        }

        /* ÙƒÙ„Ø§Ø³Ø§Øª Ù…Ø³Ø§Ø¹Ø¯Ø© Ù…Ù† Ù…Ù„ÙØ§ØªÙƒ */
        .text-gold { color: var(--gold-accent); }
        
        .bg-pattern {
            /* Ø²Ø®Ø±ÙØ© Ø¥Ø³Ù„Ø§Ù…ÙŠØ© Ø®ÙÙŠÙØ© Ø¬Ø¯Ø§Ù‹ */
            background-image: url("data:image/svg+xml,%3Csvg width='60' height='60' viewBox='0 0 60 60' xmlns='http://www.w3.org/2000/svg'%3E%3Cg fill='none' fill-rule='evenodd'%3E%3Cg fill='%23047857' fill-opacity='0.03'%3E%3Cpath d='M36 34v-4h-2v4h-4v2h4v4h2v-4h4v-2h-4zm0-30V0h-2v4h-4v2h4v4h2V6h4V4h-4zM6 34v-4H4v4H0v2h4v4h2v-4h4v-2H6zM6 4V0H4v4H0v2h4v4h2V6h4V4H6z'/%3E%3C/g%3E%3C/g%3E%3C/svg%3E");
        }

        /* ØªØ£Ø«ÙŠØ± ÙƒØ±ÙˆØª Ø§Ù„Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª */
        .stat-card {
            transition: transform 0.2s ease, box-shadow 0.2s ease;
            background: white;
            border-radius: 1rem;
            border: 1px solid #E5E7EB;
        }
        .stat-card:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1), 0 4px 6px -2px rgba(0, 0, 0, 0.05);
            border-color: var(--primary-light);
        }

        /* Checkbox Ù…Ø®ØµØµ */
        .custom-checkbox {
            appearance: none;
            -webkit-appearance: none;
            background-color: #fff;
            margin: 0;
            width: 1.5em;
            height: 1.5em;
            border: 2px solid #D1D5DB;
            border-radius: 0.5em;
            display: grid;
            place-content: center;
            cursor: pointer;
            transition: all 0.2s ease-in-out;
        }
        .custom-checkbox::before {
            content: "";
            width: 0.8em;
            height: 0.8em;
            transform: scale(0);
            transition: 120ms transform ease-in-out;
            box-shadow: inset 1em 1em white;
            transform-origin: center;
            clip-path: polygon(14% 44%, 0 65%, 50% 100%, 100% 16%, 80% 0%, 43% 62%);
        }
        .custom-checkbox:checked {
            background-color: var(--primary-color);
            border-color: var(--primary-color);
        }
        .custom-checkbox:checked::before {
            transform: scale(1);
        }

        /* Ø²Ø±Ø§Ø± ØªØ¨Ø¯ÙŠÙ„ (Toggle Switch) Ù„Ù„Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª */
        .toggle-switch {
            position: relative;
            display: inline-block;
            width: 44px;
            height: 24px;
        }
        .toggle-switch input { opacity: 0; width: 0; height: 0; }
        .slider {
            position: absolute;
            cursor: pointer;
            top: 0; left: 0; right: 0; bottom: 0;
            background-color: #ccc;
            transition: .4s;
            border-radius: 34px;
        }
        .slider:before {
            position: absolute;
            content: "";
            height: 18px;
            width: 18px;
            left: 3px;
            bottom: 3px;
            background-color: white;
            transition: .4s;
            border-radius: 50%;
        }
        input:checked + .slider { background-color: var(--primary-color); }
        input:checked + .slider:before { transform: translateX(20px); }

        /* ÙƒØ§Ø±Ø¯ ÙˆØ±Ø¯ Ø§Ù„Ù‚Ø±Ø¢Ù† Ø§Ù„Ù…Ù…ÙŠØ² */
        .quran-card {
            background: linear-gradient(135deg, #047857 0%, #064E3B 100%);
            color: white;
            position: relative;
            overflow: hidden;
        }
        .quran-card::after {
            content: '';
            position: absolute;
            top: -20px;
            left: -20px;
            width: 100px;
            height: 100px;
            background: url("data:image/svg+xml,%3Csvg width='20' height='20' viewBox='0 0 20 20' xmlns='http://www.w3.org/2000/svg'%3E%3Cpath d='M10 0l2.5 7.5L20 10l-7.5 2.5L10 20l-2.5-7.5L0 10l7.5-2.5z' fill='%23D4AF37' fill-opacity='0.1'/%3E%3C/svg%3E");
            opacity: 0.3;
        }
    </style>
</head>
<body class="bg-pattern min-h-screen flex">

    <!-- Ø§Ù„Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ø¬Ø§Ù†Ø¨ÙŠØ© (Sidebar) -->
    <aside class="w-64 bg-white hidden md:flex flex-col border-l border-gray-200 shadow-sm fixed h-full z-10">
        <div class="p-6 flex items-center justify-center border-b border-gray-100">
            <!-- ØªØ¹Ø¯ÙŠÙ„ Ø§Ù„Ø§Ø³Ù… Ù‡Ù†Ø§ -->
            <h1 class="text-xl font-bold text-[#047857]">ØªØ²ÙƒÙŠØ© ÙƒÙ…Ø´ÙƒØ§Ø© <span class="text-gold text-lg">âœ¨</span></h1>
        </div>
        
        <nav class="flex-1 p-4 space-y-2">
            <a href="#" class="flex items-center gap-3 px-4 py-3 bg-[#ECFDF5] text-[#047857] rounded-xl transition-colors font-bold">
                <i data-lucide="layout-dashboard"></i>
                <span>Ù„ÙˆØ­Ø© Ø§Ù„ØªØ­ÙƒÙ…</span>
            </a>
            <a href="#" class="flex items-center gap-3 px-4 py-3 text-gray-600 hover:bg-gray-50 hover:text-[#047857] rounded-xl transition-colors">
                <i data-lucide="bar-chart-2"></i>
                <span>Ø§Ù„ØªÙ‚Ø§Ø±ÙŠØ±</span>
            </a>
            <a href="#" class="flex items-center gap-3 px-4 py-3 text-gray-600 hover:bg-gray-50 hover:text-[#047857] rounded-xl transition-colors">
                <i data-lucide="settings"></i>
                <span>Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª</span>
            </a>
        </nav>

        <div class="p-4 border-t border-gray-100">
            <div class="bg-gray-50 p-3 rounded-lg flex items-center gap-3">
                <div class="w-10 h-10 rounded-full bg-[#047857] text-white flex items-center justify-center font-bold">Ù…</div>
                <div>
                    <p class="text-sm font-bold text-gray-800">Ù…ØµØ·ÙÙ‰</p>
                    <!-- ØªØ¹Ø¯ÙŠÙ„ Ø§Ù„Ø§Ø³Ù… Ù‡Ù†Ø§ ÙƒÙ…Ø§Ù† -->
                    <p class="text-xs text-gray-500">Ù…Ø´Ø±ÙˆØ¹ ØªØ²ÙƒÙŠØ© ÙƒÙ…Ø´ÙƒØ§Ø©</p>
                </div>
            </div>
        </div>
    </aside>

    <!-- Ø§Ù„Ù…Ø­ØªÙˆÙ‰ Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠ -->
    <main class="flex-1 md:mr-64 p-4 md:p-8 pb-24">
        
        <!-- Ø§Ù„ØªØ±ÙˆÙŠØ³Ø© -->
        <header class="flex justify-between items-center mb-8">
            <div>
                <h2 class="text-2xl font-bold text-gray-800">Ø£Ù‡Ù„Ø§Ù‹ ÙŠØ§ Ø¯Ø±Ø´ ğŸ‘‹</h2>
                <p class="text-gray-500 mt-1">"Ù‚Ù„ÙŠÙ„ Ø¯Ø§Ø¦Ù… Ø®ÙŠØ± Ù…Ù† ÙƒØ«ÙŠØ± Ù…Ù†Ù‚Ø·Ø¹" .. ÙŠÙˆÙ…Ùƒ Ù…Ø¨Ø§Ø±Ùƒ ğŸŒ¿</p>
            </div>
            <button class="md:hidden p-2 bg-white rounded-lg shadow text-[#047857]">
                <i data-lucide="menu"></i>
            </button>
        </header>

        <!-- Ù‚Ø³Ù… Ù†Ø³Ø¨Ø© Ø§Ù„Ø¥Ù†Ø¬Ø§Ø² Ø§Ù„ÙŠÙˆÙ…ÙŠ -->
        <section class="mb-8">
            <div class="bg-white p-6 rounded-2xl shadow-sm border border-gray-100 relative overflow-hidden">
                <div class="flex justify-between items-end mb-2 relative z-10">
                    <div>
                        <h3 class="text-lg font-bold text-gray-700">Ø¥Ù†Ø¬Ø§Ø² Ø§Ù„ÙŠÙˆÙ…</h3>
                        <p class="text-sm text-gray-500" id="progress-text">ÙØ§Ø¶Ù„Ùƒ 3 Ø­Ø§Ø¬Ø§Øª ÙˆØªÙ‚ÙÙ„ Ø§Ù„ÙŠÙˆÙ… ğŸ’ª</p>
                    </div>
                    <span class="text-3xl font-bold text-[#047857]" id="progress-percent">0%</span>
                </div>
                <div class="w-full bg-gray-100 rounded-full h-3 relative z-10">
                    <div class="bg-[#047857] h-3 rounded-full transition-all duration-700 ease-out" id="progress-bar" style="width: 0%"></div>
                </div>
                <!-- Ø²Ø®Ø±ÙØ© Ø®Ù„ÙÙŠØ© -->
                <div class="absolute -left-4 -bottom-10 w-32 h-32 bg-[#ECFDF5] rounded-full opacity-50"></div>
            </div>
        </section>

        <!-- 1ï¸âƒ£ Ø§Ù„Ù…Ø³ØªÙˆÙ‰ Ø§Ù„Ø£ÙˆÙ„: Ø§Ù„Ø£Ø³Ø§Ø³ÙŠ Ø§Ù„Ø«Ø§Ø¨Øª (ØµÙ„ÙˆØ§Øª + Ù‚Ø±Ø¢Ù†) -->
        <section class="mb-10">
            <div class="flex items-center gap-2 mb-4">
                <div class="w-1 h-6 bg-[#047857] rounded-full"></div>
                <h3 class="text-xl font-bold text-gray-800">Ø§Ù„Ø£Ø³Ø§Ø³ÙŠØ§Øª (Ø§Ù„Ø«ÙˆØ§Ø¨Øª) ğŸ•Œ</h3>
                <span class="text-xs bg-gray-200 text-gray-600 px-2 py-0.5 rounded-full">Ù„Ø§ ØªØ³Ù‚Ø· Ø£Ø¨Ø¯Ø§Ù‹</span>
            </div>

            <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4">
                
                <!-- ÙƒØ±ÙˆØª Ø§Ù„ØµÙ„ÙˆØ§Øª -->
                <div id="prayers-container" class="contents">
                    <!-- Ø³ÙŠØªÙ… ØªÙˆÙ„ÙŠØ¯ Ø§Ù„ØµÙ„ÙˆØ§Øª Ù‡Ù†Ø§ Ø¨Ø§Ù„Ø¬Ø§ÙØ§Ø³ÙƒØ±ÙŠØ¨Øª -->
                </div>

                <!-- ÙƒØ§Ø±Øª ÙˆØ±Ø¯ Ø§Ù„Ù‚Ø±Ø¢Ù† (Ù…Ù…ÙŠØ²) -->
                <div class="stat-card quran-card p-5 rounded-xl shadow-sm flex flex-col justify-between relative group cursor-pointer" onclick="toggleQuran()">
                    <div class="relative z-10">
                        <div class="flex justify-between items-start">
                            <div>
                                <h4 class="font-bold text-lg text-white">ÙˆØ±Ø¯ Ø§Ù„Ù‚Ø±Ø¢Ù†</h4>
                                <p class="text-emerald-100 text-sm mt-1" id="quran-status-text">ÙˆÙ„Ùˆ ØµÙØ­Ø© ÙˆØ§Ø­Ø¯Ø©.. Ù…Ø§ØªÙ‚Ø·Ø¹Ø´ Ø§Ù„Ø­Ø¨Ù„ ğŸ“¿</p>
                            </div>
                            <div class="p-2 bg-white/20 rounded-lg backdrop-blur-sm">
                                <i data-lucide="book-open" class="text-white"></i>
                            </div>
                        </div>
                    </div>
                    
                    <div class="mt-4 flex items-center gap-3 relative z-10">
                        <div id="quran-check-circle" class="w-8 h-8 rounded-full border-2 border-white/50 flex items-center justify-center transition-all">
                            <i data-lucide="check" class="w-5 h-5 text-white opacity-0 transition-opacity"></i>
                        </div>
                        <span class="text-sm font-semibold text-white" id="quran-action-text">ØªÙ…Øª Ø§Ù„Ù‚Ø±Ø§Ø¡Ø© Ø§Ù„ÙŠÙˆÙ…</span>
                    </div>
                </div>

            </div>
        </section>

        <!-- 2ï¸âƒ£ Ø§Ù„Ù…Ø³ØªÙˆÙ‰ Ø§Ù„Ø«Ø§Ù†ÙŠ: Ø§Ù„Ù…Ø±Ù† (Ø³Ù†Ù† ÙˆØ¹Ø§Ø¯Ø§Øª) -->
        <section class="mb-8">
            <div class="flex justify-between items-center mb-4">
                <div class="flex items-center gap-2">
                    <div class="w-1 h-6 bg-[#D4AF37] rounded-full"></div>
                    <h3 class="text-xl font-bold text-gray-800">Ø§Ù„Ù†ÙˆØ§ÙÙ„ ÙˆØ§Ù„Ù…Ø±ÙˆÙ†Ø© (Ø­Ø³Ø¨ Ø·Ø§Ù‚ØªÙƒ) ğŸŒ±</h3>
                </div>
                <!-- Ø²Ø± Ø§Ù„ØªØ­ÙƒÙ… ÙÙŠ Ø§Ù„Ù…Ø±ÙˆÙ†Ø© -->
                <button onclick="toggleSettingsModal()" class="text-sm text-[#047857] hover:bg-[#ECFDF5] px-3 py-1.5 rounded-lg transition-colors flex items-center gap-1">
                    <i data-lucide="sliders-horizontal" class="w-4 h-4"></i>
                    <span>ØªØ¹Ø¯ÙŠÙ„ Ø®Ø·ØªÙŠ</span>
                </button>
            </div>

            <!-- Ù…Ù†Ø·Ù‚Ø© Ø§Ù„Ø¹Ø§Ø¯Ø§Øª Ø§Ù„Ù…Ø±Ù†Ø© -->
            <div id="flexible-habits-container" class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-4">
                <!-- Ø³ÙŠØªÙ… Ù…Ù„Ø¤Ù‡Ø§ Ø¨Ø§Ù„Ø¬Ø§ÙØ§Ø³ÙƒØ±ÙŠØ¨Øª -->
            </div>
            
            <!-- Ø±Ø³Ø§Ù„Ø© Ù„Ùˆ Ù…ÙÙŠØ´ Ø¹Ø§Ø¯Ø§Øª Ù…ÙØ¹Ù„Ø© -->
            <div id="empty-habits-msg" class="hidden text-center p-8 bg-gray-50 rounded-xl border border-dashed border-gray-300">
                <p class="text-gray-500">Ù…Ø´ Ù…ÙØ¹Ù„ Ø£ÙŠ Ø³Ù†Ù† Ø¯Ù„ÙˆÙ‚ØªÙŠ.. Ø±ÙƒØ² ÙÙŠ Ø§Ù„Ø£Ø³Ø§Ø³ÙŠ ÙˆÙ…Ù…ØªØ§Ø² Ø¹Ù„ÙŠÙƒ! ğŸ‘Œ</p>
            </div>
        </section>

    </main>

    <!-- Modal: Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Ø§Ù„Ù…Ø±ÙˆÙ†Ø© (Ø§Ù„ØªØ­ÙƒÙ… ÙÙŠ Ø§Ù„Ø³Ù†Ù†) -->
    <div id="settings-modal" class="fixed inset-0 bg-black/50 z-50 hidden flex items-center justify-center backdrop-blur-sm">
        <div class="bg-white rounded-2xl w-full max-w-lg mx-4 shadow-2xl overflow-hidden animate-[fadeIn_0.2s_ease-out]">
            <div class="p-5 border-b border-gray-100 flex justify-between items-center bg-[#ECFDF5]">
                <h3 class="font-bold text-[#047857] text-lg">ØµÙ…Ù… ÙŠÙˆÙ…Ùƒ (Ø§Ù„Ù…Ø³ØªÙˆÙ‰ Ø§Ù„Ù…Ø±Ù†) ğŸ› ï¸</h3>
                <button onclick="toggleSettingsModal()" class="text-gray-500 hover:text-red-500 transition-colors">
                    <i data-lucide="x"></i>
                </button>
            </div>
            
            <div class="p-6 max-h-[60vh] overflow-y-auto">
                <p class="text-sm text-gray-500 mb-4 bg-yellow-50 p-3 rounded-lg border border-yellow-100">
                    ğŸ’¡ Ø¯ÙŠ Ø­Ø§Ø¬Ø§Øª Ø¥Ø¶Ø§ÙÙŠØ© Ù„Ù„ØªØ²ÙƒÙŠØ©ØŒ ÙØ¹Ù„ Ù…Ù†Ù‡Ø§ Ø§Ù„Ù„ÙŠ ØªÙ‚Ø¯Ø± ØªØ¯Ø§ÙˆÙ… Ø¹Ù„ÙŠÙ‡ØŒ ÙˆÙ„Ùˆ Ø­Ø³ÙŠØª Ø¨ØªÙ‚Ù„.. ÙˆÙ‚ÙÙ‡Ø§ ÙÙˆØ±Ø§Ù‹ ÙˆØ±ÙƒØ² ÙÙŠ Ø§Ù„ÙØ±ÙˆØ¶.
                </p>

                <div id="settings-list" class="space-y-4">
                    <!-- Ø³ÙŠØªÙ… ØªÙˆÙ„ÙŠØ¯ Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Ù‡Ù†Ø§ -->
                </div>
            </div>

            <div class="p-5 border-t border-gray-100 flex justify-end bg-gray-50">
                <button onclick="saveSettings()" class="bg-[#047857] hover:bg-[#065f46] text-white px-6 py-2.5 rounded-xl font-bold transition-all shadow-md hover:shadow-lg">
                    Ø­ÙØ¸ Ø§Ù„ØªØ¹Ø¯ÙŠÙ„Ø§Øª
                </button>
            </div>
        </div>
    </div>

    <!-- JavaScript Logic -->
    <script>
        // ØªÙ‡ÙŠØ¦Ø© Ø§Ù„Ø£ÙŠÙ‚ÙˆÙ†Ø§Øª
        lucide.createIcons();

        // Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª (Data State)
        // 1. Ø§Ù„Ø£Ø³Ø§Ø³ÙŠØ§Øª (Ù„Ø§ ÙŠÙ…ÙƒÙ† Ø­Ø°ÙÙ‡Ø§)
        const prayers = [
            { id: 'fajr', name: 'Ø§Ù„ÙØ¬Ø±', checked: false, time: '04:50 Øµ' },
            { id: 'dhuhr', name: 'Ø§Ù„Ø¸Ù‡Ø±', checked: false, time: '12:05 Ù…' },
            { id: 'asr', name: 'Ø§Ù„Ø¹ØµØ±', checked: false, time: '03:15 Ù…' },
            { id: 'maghrib', name: 'Ø§Ù„Ù…ØºØ±Ø¨', checked: false, time: '05:45 Ù…' },
            { id: 'isha', name: 'Ø§Ù„Ø¹Ø´Ø§Ø¡', checked: false, time: '07:15 Ù…' }
        ];

        let quranWird = { checked: false }; // Ø§Ù„ÙˆØ±Ø¯ Ø§Ù„Ù‚Ø±Ø¢Ù†ÙŠ

        // 2. Ø§Ù„Ù…Ø±Ù† (Ù‚Ø§Ø¨Ù„ Ù„Ù„ØªÙØ¹ÙŠÙ„/Ø§Ù„ØªØ¹Ø·ÙŠÙ„)
        // active: Ù‡Ù„ Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… Ù…ÙØ¹Ù„Ù‡Ø§ ÙÙŠ Ø®Ø·ØªÙ‡ØŸ | checked: Ù‡Ù„ Ø£Ù†Ø¬Ø²Ù‡Ø§ Ø§Ù„ÙŠÙˆÙ…ØŸ
        let flexibleHabits = [
            { id: 'sunan_rawatib', name: 'Ø§Ù„Ø³Ù†Ù† Ø§Ù„Ø±ÙˆØ§ØªØ¨', icon: 'layers', active: true, checked: false },
            { id: 'duha', name: 'ØµÙ„Ø§Ø© Ø§Ù„Ø¶Ø­Ù‰', icon: 'sun', active: true, checked: false },
            { id: 'witr', name: 'Ø§Ù„ÙˆØªØ±', icon: 'moon', active: false, checked: false }, // Ø§ÙØªØ±Ø§Ø¶ÙŠØ§ Ù…ØºÙ„Ù‚
            { id: 'morning_adhkar', name: 'Ø£Ø°ÙƒØ§Ø± Ø§Ù„ØµØ¨Ø§Ø­', icon: 'sunrise', active: true, checked: false },
            { id: 'evening_adhkar', name: 'Ø£Ø°ÙƒØ§Ø± Ø§Ù„Ù…Ø³Ø§Ø¡', icon: 'sunset', active: true, checked: false },
            { id: 'night_qiyam', name: 'Ù‚ÙŠØ§Ù… Ø§Ù„Ù„ÙŠÙ„', icon: 'star', active: false, checked: false }
        ];

        // === Ø¯ÙˆØ§Ù„ Ø§Ù„Ø¹Ø±Ø¶ (Rendering) ===

        function renderPrayers() {
            const container = document.getElementById('prayers-container');
            container.innerHTML = '';

            prayers.forEach((prayer, index) => {
                container.innerHTML += `
                    <div class="stat-card p-4 flex items-center justify-between cursor-pointer ${prayer.checked ? 'bg-green-50 border-green-200' : ''}" onclick="togglePrayer(${index})">
                        <div class="flex items-center gap-3">
                            <input type="checkbox" class="custom-checkbox" ${prayer.checked ? 'checked' : ''}>
                            <div>
                                <h4 class="font-bold text-gray-800 ${prayer.checked ? 'text-[#047857]' : ''}">${prayer.name}</h4>
                                <span class="text-xs text-gray-400">${prayer.time}</span>
                            </div>
                        </div>
                    </div>
                `;
            });
        }

        function renderFlexibleHabits() {
            const container = document.getElementById('flexible-habits-container');
            const emptyMsg = document.getElementById('empty-habits-msg');
            container.innerHTML = '';
            
            // ØªØµÙÙŠØ© Ø§Ù„Ø¹Ø§Ø¯Ø§Øª Ø§Ù„Ù†Ø´Ø·Ø© ÙÙ‚Ø·
            const activeHabits = flexibleHabits.filter(h => h.active);

            if (activeHabits.length === 0) {
                emptyMsg.classList.remove('hidden');
            } else {
                emptyMsg.classList.add('hidden');
                activeHabits.forEach(habit => {
                    // Ø§Ù„Ø¨Ø­Ø« Ø¹Ù† Ø§Ù„Ø§Ù†Ø¯ÙƒØ³ Ø§Ù„Ø£ØµÙ„ÙŠ ÙÙŠ Ø§Ù„Ù…ØµÙÙˆÙØ© Ø§Ù„ÙƒØ§Ù…Ù„Ø©
                    const originalIndex = flexibleHabits.findIndex(h => h.id === habit.id);
                    
                    container.innerHTML += `
                        <div class="stat-card p-4 flex items-center gap-3 cursor-pointer ${habit.checked ? 'bg-yellow-50 border-yellow-200' : ''}" onclick="toggleHabit(${originalIndex})">
                            <input type="checkbox" class="custom-checkbox" ${habit.checked ? 'checked' : ''}>
                            <div>
                                <h4 class="font-bold text-gray-800 ${habit.checked ? 'text-yellow-700' : ''}">${habit.name}</h4>
                                <span class="text-xs text-gray-400 flex items-center gap-1">
                                    <i data-lucide="${habit.icon}" class="w-3 h-3"></i>
                                    Ø³ÙÙ†Ø© / Ù†Ø§ÙÙ„Ø©
                                </span>
                            </div>
                        </div>
                    `;
                });
                lucide.createIcons(); // Ø¥Ø¹Ø§Ø¯Ø© ØªÙØ¹ÙŠÙ„ Ø§Ù„Ø£ÙŠÙ‚ÙˆÙ†Ø§Øª
            }
        }

        function renderSettingsList() {
            const list = document.getElementById('settings-list');
            list.innerHTML = '';

            flexibleHabits.forEach((habit, index) => {
                list.innerHTML += `
                    <div class="flex items-center justify-between p-3 bg-gray-50 rounded-lg">
                        <div class="flex items-center gap-3">
                            <div class="p-2 bg-white rounded-md text-gray-500 shadow-sm">
                                <i data-lucide="${habit.icon}" class="w-5 h-5"></i>
                            </div>
                            <span class="font-semibold text-gray-700">${habit.name}</span>
                        </div>
                        <label class="toggle-switch">
                            <input type="checkbox" ${habit.active ? 'checked' : ''} onchange="updateHabitActiveState(${index}, this.checked)">
                            <span class="slider"></span>
                        </label>
                    </div>
                `;
            });
            lucide.createIcons();
        }

        function updateUI() {
            renderPrayers();
            renderFlexibleHabits();
            updateQuranCardUI();
            calculateProgress();
        }

        // === Ø¯ÙˆØ§Ù„ Ø§Ù„Ù…Ù†Ø·Ù‚ (Logic) ===

        function togglePrayer(index) {
            prayers[index].checked = !prayers[index].checked;
            updateUI();
        }

        function toggleHabit(index) {
            flexibleHabits[index].checked = !flexibleHabits[index].checked;
            updateUI();
        }

        function toggleQuran() {
            quranWird.checked = !quranWird.checked;
            updateUI();
        }

        function updateQuranCardUI() {
            const card = document.querySelector('.quran-card');
            const circle = document.getElementById('quran-check-circle');
            
            // ØªØ¹Ø¯ÙŠÙ„: Ø§Ø³ØªØ®Ø¯Ø§Ù… firstElementChild Ø¨Ø¯Ù„Ø§Ù‹ Ù…Ù† querySelector('i')
            // Ù„Ø£Ù† Ù…ÙƒØªØ¨Ø© Lucide ØªØ³ØªØ¨Ø¯Ù„ i Ø¨Ù€ svg
            const checkIcon = circle ? circle.firstElementChild : null;
            
            const statusText = document.getElementById('quran-status-text');
            const actionText = document.getElementById('quran-action-text');

            // Ø­Ù…Ø§ÙŠØ© Ù…Ù† Ø§Ù„Ø®Ø·Ø£ Ù„Ùˆ Ø§Ù„Ø¹Ù†Ø§ØµØ± Ù…Ø´ Ù…ÙˆØ¬ÙˆØ¯Ø©
            if (!circle || !checkIcon || !statusText || !actionText) return;

            if (quranWird.checked) {
                // Ø­Ø§Ù„Ø© Ø§Ù„Ø¥ØªÙ…Ø§Ù…
                circle.classList.add('bg-white', 'text-[#047857]');
                circle.classList.remove('border-white/50');
                checkIcon.classList.remove('opacity-0');
                statusText.innerText = "Ø§Ù„Ù„Ù‡ ÙŠÙØªØ­ Ø¹Ù„ÙŠÙƒ! Ø²Ø§Ø¯Ùƒ Ø§Ù„Ù„Ù‡ Ù†ÙˆØ±Ø§Ù‹ âœ¨";
                actionText.innerText = "ØªÙ… Ø§Ù„ÙˆØ±Ø¯ Ø¨ÙØ¶Ù„ Ø§Ù„Ù„Ù‡";
            } else {
                // Ø­Ø§Ù„Ø© Ø¹Ø¯Ù… Ø§Ù„Ø¥ØªÙ…Ø§Ù…
                circle.classList.remove('bg-white', 'text-[#047857]');
                circle.classList.add('border-white/50');
                checkIcon.classList.add('opacity-0');
                statusText.innerText = "Ù„Ø³Ù‡ ÙÙŠÙ‡ ÙˆÙ‚ØªØŒ ØµÙØ­Ø© ÙˆØ§Ø­Ø¯Ø© ØªÙ†ÙˆØ± ÙŠÙˆÙ…Ùƒ ğŸ“–";
                actionText.innerText = "Ø§Ø¶ØºØ· Ù„Ù„ØªØ£ÙƒÙŠØ¯";
            }
        }

        function calculateProgress() {
            // Ø§Ù„Ù…Ø¹Ø§Ø¯Ù„Ø©: (Ø§Ù„ØµÙ„ÙˆØ§Øª Ø§Ù„Ù…Ù†Ø¬Ø²Ø© + Ø§Ù„Ù‚Ø±Ø¢Ù† Ø§Ù„Ù…Ù†Ø¬Ø² + Ø§Ù„Ø³Ù†Ù† Ø§Ù„Ù…ÙØ¹Ù„Ø© Ø§Ù„Ù…Ù†Ø¬Ø²Ø©) / (Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„ØµÙ„ÙˆØ§Øª + 1 Ù‚Ø±Ø¢Ù† + Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ø³Ù†Ù† Ø§Ù„Ù…ÙØ¹Ù„Ø©)
            
            const activeFlexible = flexibleHabits.filter(h => h.active);
            
            const totalTasks = prayers.length + 1 + activeFlexible.length;
            
            const completedPrayers = prayers.filter(p => p.checked).length;
            const completedQuran = quranWird.checked ? 1 : 0;
            const completedFlexible = activeFlexible.filter(h => h.checked).length;
            
            const totalCompleted = completedPrayers + completedQuran + completedFlexible;
            
            const percent = Math.round((totalCompleted / totalTasks) * 100);

            // ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø´Ø±ÙŠØ·
            document.getElementById('progress-bar').style.width = `${percent}%`;
            document.getElementById('progress-percent').innerText = `${percent}%`;

            // Ø±Ø³Ø§Ù„Ø© ØªØ´Ø¬ÙŠØ¹ÙŠØ©
            const remaining = totalTasks - totalCompleted;
            const textEl = document.getElementById('progress-text');
            
            if (percent === 100) {
                textEl.innerText = "Ù…Ø§ Ø´Ø§Ø¡ Ø§Ù„Ù„Ù‡! ÙŠÙˆÙ…Ùƒ ÙƒØ§Ù…Ù„ ğŸŒŸ";
                textEl.classList.add('text-[#047857]', 'font-bold');
            } else if (remaining === 0) {
                textEl.innerText = "Ø¨Ø¯Ø§ÙŠØ© Ù…ÙˆÙÙ‚Ø©.. ÙƒÙ…Ù„ ğŸ’ª";
            } else {
                textEl.classList.remove('text-[#047857]', 'font-bold');
                textEl.innerText = `ÙØ§Ø¶Ù„Ùƒ ${remaining} Ø®Ø·ÙˆØ§Øª Ù„ØªÙ‚ÙÙŠÙ„ Ø§Ù„ÙŠÙˆÙ… ğŸ’ª`;
            }
        }

        // === Ø¯ÙˆØ§Ù„ Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª (Settings Modal) ===

        function toggleSettingsModal() {
            const modal = document.getElementById('settings-modal');
            const isHidden = modal.classList.contains('hidden');
            
            if (isHidden) {
                renderSettingsList(); // ØªØ­Ø¯ÙŠØ« Ø§Ù„Ù‚Ø§Ø¦Ù…Ø© Ø¹Ù†Ø¯ Ø§Ù„ÙØªØ­
                modal.classList.remove('hidden');
            } else {
                modal.classList.add('hidden');
            }
        }

        function updateHabitActiveState(index, isActive) {
            flexibleHabits[index].active = isActive;
            // Ù„Ùˆ Ø¹Ø·Ù„ Ø¹Ø§Ø¯Ø©ØŒ Ù†Ù„ØºÙŠ Ø§Ù„Ù€ checked Ø¨ØªØ§Ø¹Ù‡Ø§ Ø¹Ø´Ø§Ù† Ø§Ù„Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª ØªØ¸Ø¨Ø·
            if (!isActive) flexibleHabits[index].checked = false;
        }

        function saveSettings() {
            // Ù‡Ù†Ø§ Ù…Ù…ÙƒÙ† Ù†Ø­ÙØ¸ ÙÙŠ LocalStorage Ù…Ø³ØªÙ‚Ø¨Ù„Ø§Ù‹
            updateUI(); // ØªØ­Ø¯ÙŠØ« Ø§Ù„ÙˆØ§Ø¬Ù‡Ø© Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ© Ø¨Ù†Ø§Ø¡ Ø¹Ù„Ù‰ Ø§Ù„ØªØ¹Ø¯ÙŠÙ„Ø§Øª
            toggleSettingsModal(); // Ù‚ÙÙ„ Ø§Ù„Ù…ÙˆØ¯Ø§Ù„
            
            // Ø¥Ø´Ø¹Ø§Ø± Ø¨Ø³ÙŠØ· (ÙŠÙ…ÙƒÙ† Ø§Ø³ØªØ¨Ø¯Ø§Ù„Ù‡ Ø¨Ù€ Toast)
            // alert("ØªÙ… ØªØ­Ø¯ÙŠØ« Ø®Ø·ØªÙƒ Ø¨Ù†Ø¬Ø§Ø­! ğŸ‘Œ");
        }

        // ØªØ´ØºÙŠÙ„ Ø§Ù„ØªØ·Ø¨ÙŠÙ‚ Ù„Ø£ÙˆÙ„ Ù…Ø±Ø©
        updateUI();

    </script>
</body>
</html>